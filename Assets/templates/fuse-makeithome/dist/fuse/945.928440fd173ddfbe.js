"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[945],{5945:(Ht,A,r)=>{r.r(A),r.d(A,{default:()=>Kt});var t=r(9212),p=r(1331),Y=r(8484),J=r(6263),u=r(6814),m=r(6223),_=r(2296),w=r(5986),F=r(3680),f=r(8034),U=r(6385),v=r(4170),b=r(617),R=r(4516),y=r(7988),P=r(1011),q=r(759),L=r(5037),M=r(8645),g=r(9773),h=r(9397),N=r(3620),D=r(2181),z=r(6278),x=r(6236),C=r(2651),O=r(2596),K=r(2438),k=r(5619),Z=r(2096),S=r(9839),$=r(2660),G=r(9862);let T=(()=>{class n{constructor(e){this._httpClient=e,this._tags=new k.X(null),this._task=new k.X(null),this._tasks=new k.X(null)}get tags$(){return this._tags.asObservable()}get task$(){return this._task.asObservable()}get tasks$(){return this._tasks.asObservable()}getTags(){return this._httpClient.get("api/apps/tasks/tags").pipe((0,h.b)(e=>{this._tags.next(e)}))}updateTags(){return this._httpClient.post("api/apps/tasks/tags",this._tags.value).pipe((0,h.b)(i=>{this._tags.next(i)}))}createTag(e){let i=this._tags.value||[];return e.id=S.E.guid(),i=[...i,e],this._tags.next(i),this.updateTags().subscribe(),new k.X(e).asObservable()}updateTag(e,i){let s=this._tags.value;const a=s.findIndex(l=>l.id===e);return s[a]=i,this._tags.next(s),this.updateTags().subscribe(),new k.X(i).asObservable()}deleteTag(e){let i=this._tags.value,s=this._tasks.value;const a=i.findIndex(l=>l.id===e);return i.splice(a,1),this._tags.next(i),s.forEach(l=>{const d=l.tags.findIndex(Q=>Q===e);d>-1&&(l.tags.splice(d,1),this._tasks.next(s),this.updateTasks().subscribe())}),this.updateTags().subscribe(),new k.X(!0).asObservable()}getTasks(){return this._httpClient.get("api/apps/tasks").pipe((0,h.b)(e=>{this._tasks.next(e)}))}updateTasksOrders(e){return this._tasks.value.forEach(i=>{i.order=e.findIndex(s=>s.id===i.id)}),this._tasks.next(e),this._httpClient.patch("api/apps/tasks",e)}updateTasks(){let e=this._tasks.getValue();return this._httpClient.post("api/apps/tasks",e).pipe((0,h.b)(i=>{B(i,e)||setTimeout(()=>{this.updateTasks().subscribe()},100)}))}searchTasks(e){let i;if(e){let a=(0,$.Z)(this._tasks.value);a=a.filter(c=>c.title&&c.title.toLowerCase().includes(e.toLowerCase())||c.notes&&c.notes.toLowerCase().includes(e.toLowerCase())),a.forEach(c=>{const l=new RegExp("("+e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+")","ig");c.title=c.title.replace(l,"<mark>$1</mark>")}),i=a}else i=null;return new k.X(i).asObservable()}getTaskById(e){const s=this._tasks.value.find(a=>a.id===e)||null;return this._task.next(s),(0,Z.of)(s)}createTask(e){let i=this._tasks.value||[];const s={id:S.E.guid(),type:e,title:"",notes:null,completed:!1,dueDate:null,priority:1,tags:[],order:0};return this._tasks.next([s,...i]),this.updateTasks().subscribe(),(0,Z.of)(s)}updateTask(e,i){let s=this._tasks.value;const a=s.findIndex(c=>c.id===e);return s[a]=i,this._tasks.next(s),this.updateTasks().subscribe(),(0,Z.of)(i)}deleteTask(e){let i=this._tasks.value;const s=i.findIndex(a=>a.id===e);return i.splice(s,1),this._tasks.next(i),this.updateTasks().subscribe(),(0,Z.of)(!0)}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(G.eN))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function B(n,o){if(typeof n!=typeof o)return!1;if(n===o)return!0;if(null===n||null===o)return!1;if("object"==typeof n&&"object"==typeof o){const e=Object.keys(n),i=Object.keys(o);if(e.length!==i.length)return!1;for(const s of e)if(!B(n[s],o[s]))return!1;return!0}return!1}var H=r(9236),j=r(193);const V=["matDrawer"];function X(n,o){1&n&&(t.TgZ(0,"span"),t._uU(1,"All tasks completed!"),t.qZA())}function W(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij("",e.tasksCount.incomplete," remaining tasks")}}function tt(n,o){1&n&&t._UZ(0,"div",28)}function et(n,o){1&n&&(t.ynx(0),t._UZ(1,"div",29),t.BQk())}function nt(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",31),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_outline:check-circle"))}function st(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",32),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_outline:check-circle"))}function it(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",30),t.NdJ("click",function(){t.CHM(e);const s=t.oxw().$implicit,a=t.oxw(2);return t.KtG(a.toggleCompleted(s))}),t.YNc(1,nt,2,1,"ng-container",9)(2,st,2,1,"ng-container",9),t.qZA()}if(2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.completed),t.xp6(1),t.Q6J("ngIf",!e.completed)}}function at(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.Oqu(e.title)}}function ot(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"span",33),t._uU(2),t.ALo(3,"titlecase"),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.hij("",t.lcZ(3,1,e.type)," title")}}function rt(n,o){1&n&&t._UZ(0,"mat-icon",37),2&n&&t.Q6J("svgIcon","heroicons_mini:arrow-long-down")("title","Low")}function ct(n,o){1&n&&t._UZ(0,"mat-icon",38),2&n&&t.Q6J("svgIcon","heroicons_mini:arrow-long-up")("title","High")}function lt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",34),t.YNc(2,rt,1,2,"mat-icon",35)(3,ct,1,2,"mat-icon",36),t.qZA(),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("ngIf",0===e.priority),t.xp6(1),t.Q6J("ngIf",2===e.priority)}}function gt(n,o){if(1&n&&(t.TgZ(0,"div",39),t._uU(1),t.ALo(2,"date"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,e.dueDate,"LLL dd")," ")}}const pt=(n,o,e)=>({"h-12 text-lg font-semibold bg-gray-50 dark:bg-transparent":n,"h-16":o,"text-hint":e}),ut=n=>[n];function dt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",19),t.YNc(2,tt,1,0,"div",20),t.TgZ(3,"div",21),t.YNc(4,et,2,0,"ng-container",9),t.TgZ(5,"div",22),t._UZ(6,"mat-icon",23),t.qZA(),t.YNc(7,it,3,2,"button",24),t.TgZ(8,"a",25)(9,"div",26),t.YNc(10,at,3,1,"ng-container",9)(11,ot,4,3,"ng-container",9),t.qZA(),t.YNc(12,lt,4,2,"ng-container",9)(13,gt,3,4,"div",27),t.qZA()()(),t.BQk()),2&n){const e=o.$implicit,i=o.first,s=t.oxw(2);t.xp6(1),t.ekj("border-t",i),t.Q6J("id","task-"+e.id)("ngClass",t.kEZ(13,pt,"section"===e.type,"task"===e.type,e.completed))("cdkDragLockAxis","y"),t.xp6(3),t.Q6J("ngIf",s.selectedTask&&s.selectedTask.id===e.id),t.xp6(2),t.Q6J("svgIcon","heroicons_solid:bars-3"),t.xp6(1),t.Q6J("ngIf","task"===e.type),t.xp6(1),t.Q6J("routerLink",t.VKq(17,ut,e.id)),t.xp6(2),t.Q6J("ngIf",e.title),t.xp6(1),t.Q6J("ngIf",!e.title),t.xp6(1),t.Q6J("ngIf","task"===e.type),t.xp6(1),t.Q6J("ngIf","task"===e.type)}}function mt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",17),t.NdJ("cdkDropListDropped",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.dropped(s))}),t.YNc(2,dt,14,19,"ng-container",18),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("cdkDropListData",e.tasks),t.xp6(1),t.Q6J("ngForOf",e.tasks)("ngForTrackBy",e.trackByFn)}}function _t(n,o){1&n&&(t.TgZ(0,"div",40),t._UZ(1,"mat-icon",41),t.TgZ(2,"div",42),t._uU(3,"Add a task to start planning!"),t.qZA()()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_outline:clipboard-document-list"))}let E=(()=>{class n{constructor(e,i,s,a,c,l,d){this._activatedRoute=e,this._changeDetectorRef=i,this._document=s,this._router=a,this._tasksService=c,this._fuseMediaWatcherService=l,this._fuseNavigationService=d,this.tasksCount={completed:0,incomplete:0,total:0},this._unsubscribeAll=new M.x}ngOnInit(){this._tasksService.tags$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this.tasksCount.total=this.tasks.filter(i=>"task"===i.type).length,this.tasksCount.completed=this.tasks.filter(i=>"task"===i.type&&i.completed).length,this.tasksCount.incomplete=this.tasksCount.total-this.tasksCount.completed,this._changeDetectorRef.markForCheck(),setTimeout(()=>{const i=this._fuseNavigationService.getComponent("mainNavigation");i&&(this._fuseNavigationService.getItem("apps.tasks",i.navigation).subtitle=this.tasksCount.incomplete+" remaining tasks",i.refresh())})}),this._tasksService.task$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(e=>{this.selectedTask=e,this._changeDetectorRef.markForCheck()}),this._fuseMediaWatcherService.onMediaQueryChange$("(min-width: 1440px)").pipe((0,g.R)(this._unsubscribeAll)).subscribe(e=>{this.drawerMode=e.matches?"side":"over",this._changeDetectorRef.markForCheck()}),(0,K.R)(this._document,"keydown").pipe((0,g.R)(this._unsubscribeAll),(0,D.h)(e=>(!0===e.ctrlKey||e.metaKey)&&("/"===e.key||"."===e.key))).subscribe(e=>{"/"===e.key&&this.createTask("task"),"."===e.key&&this.createTask("section")})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}onBackdropClicked(){this._router.navigate(["./"],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()}createTask(e){this._tasksService.createTask(e).subscribe(i=>{this._router.navigate(["./",i.id],{relativeTo:this._activatedRoute}),this._changeDetectorRef.markForCheck()})}toggleCompleted(e){e.completed=!e.completed,this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}dropped(e){(0,x.bA)(e.container.data,e.previousIndex,e.currentIndex),this._tasksService.updateTasksOrders(e.container.data).subscribe(),this._changeDetectorRef.markForCheck()}trackByFn(e,i){return i.id||e}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(p.gz),t.Y36(t.sBO),t.Y36(u.K0),t.Y36(p.F0),t.Y36(T),t.Y36(H.T),t.Y36(j.Jf))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["tasks-list"]],viewQuery:function(i,s){if(1&i&&t.Gf(V,7),2&i){let a;t.iGM(a=t.CRH())&&(s.matDrawer=a.first)}},standalone:!0,features:[t.jDz],decls:26,vars:14,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-hidden"],[1,"flex-auto","h-full","bg-card","dark:bg-transparent",3,"backdropClick"],[1,"w-full","sm:w-128","dark:bg-gray-900",3,"mode","opened","position","disableClose"],["matDrawer",""],[1,"flex","flex-col"],[1,"flex","flex-col","flex-auto"],[1,"flex","flex-col","sm:flex-row","items-start","sm:items-center","sm:justify-between","py-8","px-6","md:px-8"],[1,"text-4xl","font-extrabold","tracking-tight","leading-none"],[1,"ml-0.5","font-medium","text-secondary"],[4,"ngIf"],[1,"mt-4","sm:mt-0"],["mat-flat-button","",3,"color","matTooltip","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],["mat-flat-button","",1,"ml-3",3,"color","matTooltip","click"],[4,"ngIf","ngIfElse"],["noTasks",""],["cdkDropList","",1,"divide-y",3,"cdkDropListData","cdkDropListDropped"],[4,"ngFor","ngForOf","ngForTrackBy"],["cdkDrag","",1,"group","w-full","select-none","hover:bg-gray-100","dark:hover:bg-hover",3,"id","ngClass","cdkDragLockAxis"],["class","flex flex-0 w-0 h-0",4,"cdkDragPreview"],[1,"relative","flex","items-center","h-full","pl-10"],["cdkDragHandle","",1,"md:hidden","absolute","flex","items-center","justify-center","inset-y-0","left-0","w-8","cursor-move","md:group-hover:flex"],[1,"icon-size-5","text-hint",3,"svgIcon"],["class","mr-2 -ml-2.5 leading-none","mat-icon-button","",3,"click",4,"ngIf"],[1,"flex","flex-auto","items-center","min-w-0","h-full","pr-7",3,"routerLink"],[1,"flex-auto","mr-2","truncate"],["class","text-sm whitespace-nowrap text-secondary",4,"ngIf"],[1,"flex","flex-0","w-0","h-0"],[1,"z-10","absolute","-top-px","right-0","-bottom-px","flex","flex-0","w-1","bg-primary"],["mat-icon-button","",1,"mr-2","-ml-2.5","leading-none",3,"click"],[1,"text-primary",3,"svgIcon"],[1,"text-hint",3,"svgIcon"],[1,"select-none","text-hint"],[1,"w-4","h-4","mr-3"],["class","icon-size-4 text-green-600 dark:text-green-400",3,"svgIcon","title",4,"ngIf"],["class","icon-size-4 text-red-600 dark:text-red-400",3,"svgIcon","title",4,"ngIf"],[1,"icon-size-4","text-green-600","dark:text-green-400",3,"svgIcon","title"],[1,"icon-size-4","text-red-600","dark:text-red-400",3,"svgIcon","title"],[1,"text-sm","whitespace-nowrap","text-secondary"],[1,"flex","flex-auto","flex-col","items-center","justify-center","bg-gray-100","dark:bg-transparent"],[1,"icon-size-24",3,"svgIcon"],[1,"mt-4","text-2xl","font-semibold","tracking-tight","text-secondary"]],template:function(i,s){if(1&i&&(t.TgZ(0,"div",0)(1,"mat-drawer-container",1),t.NdJ("backdropClick",function(){return s.onBackdropClicked()}),t.TgZ(2,"mat-drawer",2,3),t._UZ(4,"router-outlet"),t.qZA(),t.TgZ(5,"mat-drawer-content",4)(6,"div",5)(7,"div",6)(8,"div")(9,"div",7),t._uU(10,"Tasks"),t.qZA(),t.TgZ(11,"div",8),t.YNc(12,X,2,0,"span",9)(13,W,2,1,"span",9),t.qZA()(),t.TgZ(14,"div",10)(15,"button",11),t.NdJ("click",function(){return s.createTask("section")}),t._UZ(16,"mat-icon",12),t.TgZ(17,"span",13),t._uU(18,"Add Section"),t.qZA()(),t.TgZ(19,"button",14),t.NdJ("click",function(){return s.createTask("task")}),t._UZ(20,"mat-icon",12),t.TgZ(21,"span",13),t._uU(22,"Add Task"),t.qZA()()()(),t.YNc(23,mt,3,3,"ng-container",15)(24,_t,4,1,"ng-template",null,16,t.W1O),t.qZA()()()()),2&i){const a=t.MAs(25);t.xp6(2),t.Q6J("mode",s.drawerMode)("opened",!1)("position","end")("disableClose",!0),t.xp6(10),t.Q6J("ngIf",0===s.tasksCount.incomplete),t.xp6(1),t.Q6J("ngIf",0!==s.tasksCount.incomplete),t.xp6(2),t.Q6J("color","accent")("matTooltip","Shortcut: Ctrl + ."),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(3),t.Q6J("color","primary")("matTooltip","Shortcut: Ctrl + /"),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus"),t.xp6(3),t.Q6J("ngIf",s.tasks&&s.tasks.length>0)("ngIfElse",a)}},dependencies:[C.SJ,C.jA,C.kh,C.LW,p.lC,u.O5,_.ot,_.lW,_.RK,O.AV,O.gM,b.Ps,b.Hw,x.Wj,u.ax,x.Zt,u.mk,x.pV,x.Bh,p.rH,u.rS,u.uU],encapsulation:2,changeDetection:0})}return n})();var kt=r(9594);const ft=["tagsPanelOrigin"],ht=["tagsPanel"],xt=["titleField"];function Tt(n,o){1&n&&(t.ynx(0),t.TgZ(1,"div",39),t._UZ(2,"mat-icon",7),t.TgZ(3,"span",40),t._uU(4,"MARK AS COMPLETE"),t.qZA()(),t.BQk()),2&n&&(t.xp6(2),t.Q6J("svgIcon","heroicons_outline:check-circle"))}function vt(n,o){1&n&&(t.ynx(0),t.TgZ(1,"div",39),t._UZ(2,"mat-icon",41),t.TgZ(3,"span",40),t._uU(4,"MARK AS INCOMPLETE"),t.qZA()(),t.BQk()),2&n&&(t.xp6(2),t.Q6J("svgIcon","heroicons_outline:check-circle"))}function bt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",43)(2,"span",44),t._uU(3),t.qZA()(),t.BQk()),2&n){const e=o.$implicit;t.xp6(3),t.Oqu(e.title)}}function yt(n,o){if(1&n&&(t.ynx(0),t.YNc(1,bt,4,1,"ng-container",42),t.ALo(2,"fuseFindByKey"),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.Dn7(2,2,e.task.tags,"id",e.tags))("ngForTrackBy",e.trackByFn)}}function Ct(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",45),t.TgZ(2,"span",46),t._uU(3,"Edit"),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_solid:pencil-square"))}function Zt(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",45),t.TgZ(2,"span",46),t._uU(3,"Add"),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_solid:plus-circle"))}function Dt(n,o){1&n&&t._UZ(0,"mat-icon",45),2&n&&t.Q6J("svgIcon","heroicons_solid:pencil-square")}function It(n,o){1&n&&t._UZ(0,"mat-icon",45),2&n&&t.Q6J("svgIcon","heroicons_solid:check")}function Qt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",56),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(3);return t.KtG(c.toggleTaskTag(a))}),t._UZ(2,"mat-checkbox",57),t.TgZ(3,"div",58),t._uU(4),t.qZA()(),t.BQk()}if(2&n){const e=o.$implicit,i=t.oxw(3);t.xp6(2),t.Q6J("checked",i.task.tags.includes(e.id))("color","primary")("disableRipple",!0),t.xp6(2),t.Oqu(e.title)}}function At(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Qt,5,4,"ng-container",42),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.filteredTags)("ngForTrackBy",e.trackByFn)}}function Jt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",5)(2,"mat-form-field",60)(3,"input",61),t.NdJ("input",function(s){const c=t.CHM(e).$implicit,l=t.oxw(3);return t.KtG(l.updateTagTitle(c,s))}),t.qZA(),t.TgZ(4,"button",62),t.NdJ("click",function(){const a=t.CHM(e).$implicit,c=t.oxw(3);return t.KtG(c.deleteTag(a))}),t._UZ(5,"mat-icon",63),t.qZA()()(),t.BQk()}if(2&n){const e=o.$implicit;t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("value",e.title),t.xp6(2),t.Q6J("svgIcon","heroicons_solid:trash")}}function wt(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",59),t.YNc(2,Jt,6,3,"ng-container",42),t.qZA(),t.BQk()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.filteredTags)("ngForTrackBy",e.trackByFn)}}function Ft(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",64),t.NdJ("click",function(){t.CHM(e),t.oxw();const s=t.MAs(6);return t.oxw().createTag(s.value),t.KtG(s.value="")}),t._UZ(1,"mat-icon",65),t.TgZ(2,"div",66),t._uU(3,'Create "'),t.TgZ(4,"b"),t._uU(5),t.qZA(),t._uU(6,'"'),t.qZA()()}if(2&n){t.oxw();const e=t.MAs(6);t.xp6(1),t.Q6J("svgIcon","heroicons_solid:plus-circle"),t.xp6(4),t.Oqu(e.value)}}function Ut(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",47)(1,"div",48)(2,"div",5),t._UZ(3,"mat-icon",45),t.TgZ(4,"div",49)(5,"input",50,51),t.NdJ("input",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.filterTags(s))})("keydown",function(s){t.CHM(e);const a=t.oxw();return t.KtG(a.filterTagsInputKeyDown(s))}),t.qZA()()(),t.TgZ(7,"button",52),t.NdJ("click",function(){t.CHM(e);const s=t.oxw();return t.KtG(s.toggleTagsEditMode())}),t.YNc(8,Dt,1,1,"mat-icon",53)(9,It,1,1,"mat-icon",53),t.qZA()(),t.TgZ(10,"div",54),t.YNc(11,At,2,2,"ng-container",4)(12,wt,3,2,"ng-container",4)(13,Ft,7,2,"div",55),t.qZA()()}if(2&n){const e=t.MAs(6),i=t.oxw();t.xp6(3),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(2),t.Q6J("maxLength",30),t.xp6(3),t.Q6J("ngIf",!i.tagsEditMode),t.xp6(1),t.Q6J("ngIf",i.tagsEditMode),t.xp6(2),t.Q6J("ngIf",!i.tagsEditMode),t.xp6(1),t.Q6J("ngIf",i.tagsEditMode),t.xp6(1),t.Q6J("ngIf",i.shouldShowCreateTagButton(e.value))}}function Rt(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",67),t.TgZ(2,"span",68),t._uU(3,"Low"),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_mini:arrow-long-down"))}function Lt(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",67),t.TgZ(2,"span",68),t._uU(3,"Normal"),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_solid:minus"))}function Mt(n,o){1&n&&(t.ynx(0),t._UZ(1,"mat-icon",67),t.TgZ(2,"span",68),t._uU(3,"High"),t.qZA(),t.BQk()),2&n&&(t.xp6(1),t.Q6J("svgIcon","heroicons_mini:arrow-long-up"))}function Nt(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"date"),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,e.task.dueDate,"longDate"))}}function Ot(n,o){1&n&&(t.ynx(0),t._uU(1,"Not set"),t.BQk())}const St=()=>["../"],Bt=(n,o,e)=>({"text-green-800 bg-green-200 dark:text-green-100 dark:bg-green-500":n,"text-gray-800 bg-gray-200 dark:text-gray-100 dark:bg-gray-500":o,"text-red-800 bg-red-200 dark:text-red-100 dark:bg-red-500":e}),I=n=>({"bg-hover":n}),Et=(n,o,e)=>({"text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700":n,"text-green-800 bg-green-200 dark:text-green-100 dark:bg-green-500":o,"text-red-800 bg-red-200 dark:text-red-100 dark:bg-red-500":e});let Yt=(()=>{class n{constructor(e,i,s,a,c,l,d,Q,$t,Gt){this._activatedRoute=e,this._changeDetectorRef=i,this._formBuilder=s,this._fuseConfirmationService=a,this._renderer2=c,this._router=l,this._tasksListComponent=d,this._tasksService=Q,this._overlay=$t,this._viewContainerRef=Gt,this.tagsEditMode=!1,this._unsubscribeAll=new M.x}ngOnInit(){this._tasksListComponent.matDrawer.open(),this.taskForm=this._formBuilder.group({id:[""],type:[""],title:[""],notes:[""],completed:[!1],dueDate:[null],priority:[0],tags:[[]],order:[0]}),this._tasksService.tags$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(e=>{this.tags=e,this.filteredTags=e,this._changeDetectorRef.markForCheck()}),this._tasksService.tasks$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(e=>{this.tasks=e,this._changeDetectorRef.markForCheck()}),this._tasksService.task$.pipe((0,g.R)(this._unsubscribeAll)).subscribe(e=>{this._tasksListComponent.matDrawer.open(),this.task=e,this.taskForm.patchValue(e,{emitEvent:!1}),this._changeDetectorRef.markForCheck()}),this.taskForm.valueChanges.pipe((0,h.b)(e=>{this.task=(0,q.Z)(this.task,e)}),(0,N.b)(300),(0,g.R)(this._unsubscribeAll)).subscribe(e=>{this._tasksService.updateTask(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()}),this._router.events.pipe((0,g.R)(this._unsubscribeAll),(0,D.h)(e=>e instanceof p.m2)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngAfterViewInit(){this._tasksListComponent.matDrawer.openedChange.pipe((0,g.R)(this._unsubscribeAll),(0,D.h)(e=>e)).subscribe(()=>{this._titleField.nativeElement.focus()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.dispose()}closeDrawer(){return this._tasksListComponent.matDrawer.close()}toggleCompleted(){const e=this.taskForm.get("completed");e.setValue(!e.value)}openTagsPanel(){this._tagsPanelOverlayRef=this._overlay.create({backdropClass:"",hasBackdrop:!0,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:this._overlay.position().flexibleConnectedTo(this._tagsPanelOrigin.nativeElement).withFlexibleDimensions(!0).withViewportMargin(64).withLockedPosition(!0).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}])}),this._tagsPanelOverlayRef.attachments().subscribe(()=>{this._tagsPanelOverlayRef.overlayElement.querySelector("input").focus()});const e=new Y.UE(this._tagsPanel,this._viewContainerRef);this._tagsPanelOverlayRef.attach(e),this._tagsPanelOverlayRef.backdropClick().subscribe(()=>{this._tagsPanelOverlayRef&&this._tagsPanelOverlayRef.hasAttached()&&(this._tagsPanelOverlayRef.detach(),this.filteredTags=this.tags,this.tagsEditMode=!1),e&&e.isAttached&&e.detach()})}toggleTagsEditMode(){this.tagsEditMode=!this.tagsEditMode}filterTags(e){const i=e.target.value.toLowerCase();this.filteredTags=this.tags.filter(s=>s.title.toLowerCase().includes(i))}filterTagsInputKeyDown(e){if("Enter"!==e.key)return;if(0===this.filteredTags.length)return this.createTag(e.target.value),void(e.target.value="");const i=this.filteredTags[0];this.task.tags.find(a=>a===i.id)?this.deleteTagFromTask(i):this.addTagToTask(i)}createTag(e){this._tasksService.createTag({title:e}).subscribe(s=>{this.addTagToTask(s)})}updateTagTitle(e,i){e.title=i.target.value,this._tasksService.updateTag(e.id,e).pipe((0,N.b)(300)).subscribe(),this._changeDetectorRef.markForCheck()}deleteTag(e){this._tasksService.deleteTag(e.id).subscribe(),this._changeDetectorRef.markForCheck()}addTagToTask(e){this.task.tags.unshift(e.id),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}deleteTagFromTask(e){this.task.tags.splice(this.task.tags.findIndex(i=>i===e.id),1),this.taskForm.get("tags").patchValue(this.task.tags),this._changeDetectorRef.markForCheck()}toggleTaskTag(e){this.task.tags.includes(e.id)?this.deleteTagFromTask(e):this.addTagToTask(e)}shouldShowCreateTagButton(e){return!(""===e||this.tags.findIndex(i=>i.title.toLowerCase()===e.toLowerCase())>-1)}setTaskPriority(e){this.taskForm.get("priority").setValue(e)}isOverdue(){return L.ou.fromISO(this.task.dueDate).startOf("day")<L.ou.now().startOf("day")}deleteTask(){this._fuseConfirmationService.open({title:"Delete task",message:"Are you sure you want to delete this task? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(i=>{if("confirmed"===i){const s=this.task.id,a=this.tasks.findIndex(d=>d.id===s),l=1===this.tasks.length&&this.tasks[0].id===s?null:this.tasks[a+(a===this.tasks.length-1?-1:1)].id;this._tasksService.deleteTask(s).subscribe(d=>{d&&this._router.navigate(l?["../",l]:["../"],{relativeTo:this._activatedRoute})}),this._changeDetectorRef.markForCheck()}})}trackByFn(e,i){return i.id||e}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(p.gz),t.Y36(t.sBO),t.Y36(m.QS),t.Y36(z.R),t.Y36(t.Qsj),t.Y36(p.F0),t.Y36(E),t.Y36(T),t.Y36(kt.aV),t.Y36(t.s_b))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["tasks-details"]],viewQuery:function(i,s){if(1&i&&(t.Gf(ft,5),t.Gf(ht,5),t.Gf(xt,5)),2&i){let a;t.iGM(a=t.CRH())&&(s._tagsPanelOrigin=a.first),t.iGM(a=t.CRH())&&(s._tagsPanel=a.first),t.iGM(a=t.CRH())&&(s._titleField=a.first)}},standalone:!0,features:[t.jDz],decls:82,vars:53,consts:[[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","p-6","pt-10","sm:p-8","sm:pt-10","overflow-y-auto",3,"formGroup"],[1,"flex","items-center","justify-between","-mt-3","-ml-4"],["mat-button","",1,"pr-4","pl-3.5",3,"click"],[4,"ngIf"],[1,"flex","items-center"],["mat-icon-button","",3,"matMenuTriggerFor"],[3,"svgIcon"],["moreMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-icon-button","",3,"routerLink"],[1,"mt-6","mb-8"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","spellcheck"],["titleField",""],[1,"mt-8"],[1,"font-medium","mb-1.5"],[1,"flex","flex-wrap","items-center","-m-1.5"],[1,"flex","items-center","justify-center","px-4","m-1.5","rounded-full","leading-9","cursor-pointer","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700",3,"click"],["tagsPanelOrigin",""],["tagsPanel",""],[1,"flex","flex-wrap","items-center","mt-8"],[1,"font-medium"],[1,"flex","items-center","mt-1.5","px-4","leading-9","rounded-full","cursor-pointer",3,"ngClass","matMenuTriggerFor"],["priorityMenu","matMenu"],["mat-menu-item","",3,"ngClass","click"],[1,"inline-flex","items-center","justify-between","w-full","min-w-30","leading-5"],[1,"mr-0","icon-size-4","text-green-600","dark:text-green-500",3,"svgIcon"],[1,"mr-0","icon-size-4","text-gray-600","dark:text-gray-500",3,"svgIcon"],[1,"mr-0","icon-size-4","text-red-600","dark:text-red-500",3,"svgIcon"],[1,"ml-6"],[1,"relative","flex","items-center","mt-1.5","px-4","leading-9","rounded-full","cursor-pointer",3,"ngClass","click"],[1,"icon-size-5","text-current",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[1,"fuse-mat-dense","invisible","absolute","inset-0","-mt-2.5","opacity-0","pointer-events-none",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["dueDatePicker",""],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",1,"",3,"color"],[1,"flex","items-center","justify-center"],[1,"ml-2","font-semibold"],[1,"text-primary",3,"svgIcon"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","justify-center","px-4","m-1.5","rounded-full","leading-9","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"text-md","font-medium","whitespace-nowrap"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-1.5","text-md","font-medium","whitespace-nowrap"],[1,"w-60","rounded","border","shadow-md","bg-card"],[1,"flex","items-center","m-3","mr-2"],[1,"ml-2"],["type","text","placeholder","Enter tag name",1,"w-full","min-w-0","py-1","border-0",3,"maxLength","input","keydown"],["newTagInput",""],["mat-icon-button","",1,"ml-1",3,"click"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"flex","flex-col","max-h-64","py-2","border-t","overflow-y-auto"],["class","flex items-center h-10 min-h-10 -ml-0.5 pl-4 pr-3 leading-none cursor-pointer hover:bg-hover","matRipple","",3,"click",4,"ngIf"],["matRipple","",1,"flex","items-center","h-10","min-h-10","pl-1","pr-4","cursor-pointer","hover:bg-hover",3,"click"],[1,"flex","items-center","h-10","min-h-10","pointer-events-none",3,"checked","color","disableRipple"],[1,"ml-1"],[1,"py-2","space-y-2"],[1,"fuse-mat-dense","w-full","mx-4",3,"subscriptSizing"],["matInput","",3,"value","input"],["mat-icon-button","","matSuffix","",3,"click"],[1,"icon-size-5","ml-2",3,"svgIcon"],["matRipple","",1,"flex","items-center","h-10","min-h-10","-ml-0.5","pl-4","pr-3","leading-none","cursor-pointer","hover:bg-hover",3,"click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"break-all"],[1,"icon-size-4","text-current",3,"svgIcon"],[1,"ml-2","mr-1","text-md","font-medium"]],template:function(i,s){if(1&i){const a=t.EpF();t.TgZ(0,"div",0)(1,"form",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return s.toggleCompleted()}),t.YNc(4,Tt,5,1,"ng-container",4)(5,vt,5,1,"ng-container",4),t.qZA(),t.TgZ(6,"div",5)(7,"button",6),t._UZ(8,"mat-icon",7),t.qZA(),t.TgZ(9,"mat-menu",null,8)(11,"button",9),t.NdJ("click",function(){return s.deleteTask()}),t._UZ(12,"mat-icon",7),t.TgZ(13,"span"),t._uU(14),t.qZA()()(),t.TgZ(15,"a",10),t._UZ(16,"mat-icon",7),t.qZA()()(),t._UZ(17,"mat-divider",11),t.TgZ(18,"div")(19,"mat-form-field",12)(20,"mat-label"),t._uU(21),t.qZA(),t._UZ(22,"textarea",13,14),t.qZA()(),t.TgZ(24,"div",15)(25,"div",16),t._uU(26,"Tags"),t.qZA(),t.TgZ(27,"div",17),t.YNc(28,yt,3,6,"ng-container",4),t.TgZ(29,"div",18,19),t.NdJ("click",function(){return s.openTagsPanel()}),t.YNc(31,Ct,4,1,"ng-container",4)(32,Zt,4,1,"ng-container",4)(33,Ut,14,7,"ng-template",null,20,t.W1O),t.qZA()()(),t.TgZ(35,"div",21)(36,"div")(37,"div",22),t._uU(38,"Priority"),t.qZA(),t.TgZ(39,"div",23),t.YNc(40,Rt,4,1,"ng-container",4)(41,Lt,4,1,"ng-container",4)(42,Mt,4,1,"ng-container",4),t.qZA(),t.TgZ(43,"mat-menu",null,24)(45,"button",25),t.NdJ("click",function(){return s.setTaskPriority(0)}),t.TgZ(46,"span",26)(47,"span",22),t._uU(48,"Low"),t.qZA(),t._UZ(49,"mat-icon",27),t.qZA()(),t.TgZ(50,"button",25),t.NdJ("click",function(){return s.setTaskPriority(1)}),t.TgZ(51,"span",26)(52,"span",22),t._uU(53,"Normal"),t.qZA(),t._UZ(54,"mat-icon",28),t.qZA()(),t.TgZ(55,"button",25),t.NdJ("click",function(){return s.setTaskPriority(2)}),t.TgZ(56,"span",26)(57,"span",22),t._uU(58,"High"),t.qZA(),t._UZ(59,"mat-icon",29),t.qZA()()()(),t.TgZ(60,"div",30)(61,"div",22),t._uU(62,"Due date"),t.qZA(),t.TgZ(63,"div",31),t.NdJ("click",function(){t.CHM(a);const l=t.MAs(71);return t.KtG(l.open())}),t._UZ(64,"mat-icon",32),t.TgZ(65,"span",33),t.YNc(66,Nt,3,4,"ng-container",4)(67,Ot,2,0,"ng-container",4),t.qZA(),t.TgZ(68,"mat-form-field",34),t._UZ(69,"input",35),t.TgZ(70,"mat-datepicker",null,36)(72,"mat-datepicker-actions")(73,"button",37),t.NdJ("click",function(){return s.taskForm.get("dueDate").setValue(null)}),t._uU(74,"Clear "),t.qZA(),t.TgZ(75,"button",38),t._uU(76,"Select "),t.qZA()()()()()()(),t.TgZ(77,"div",15)(78,"mat-form-field",12)(79,"mat-label"),t._uU(80,"Notes"),t.qZA(),t._UZ(81,"textarea",13),t.qZA()()()()}if(2&i){const a=t.MAs(10),c=t.MAs(44),l=t.MAs(71);t.xp6(1),t.Q6J("formGroup",s.taskForm),t.xp6(3),t.Q6J("ngIf",!s.taskForm.get("completed").value),t.xp6(1),t.Q6J("ngIf",s.taskForm.get("completed").value),t.xp6(2),t.Q6J("matMenuTriggerFor",a),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:ellipsis-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_outline:trash"),t.xp6(2),t.hij("Delete ","task"===s.task.type?"task":"section",""),t.xp6(1),t.Q6J("routerLink",t.DdM(38,St)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(3),t.Q6J("subscriptSizing","dynamic"),t.xp6(2),t.Oqu("task"===s.task.type?"Task title":"Section title"),t.xp6(1),t.Q6J("formControlName","title")("spellcheck",!1),t.xp6(6),t.Q6J("ngIf",s.task.tags.length),t.xp6(3),t.Q6J("ngIf",s.task.tags.length),t.xp6(1),t.Q6J("ngIf",!s.task.tags.length),t.xp6(7),t.Q6J("ngClass",t.kEZ(39,Bt,0===s.task.priority,1===s.task.priority,2===s.task.priority))("matMenuTriggerFor",c),t.xp6(1),t.Q6J("ngIf",0===s.task.priority),t.xp6(1),t.Q6J("ngIf",1===s.task.priority),t.xp6(1),t.Q6J("ngIf",2===s.task.priority),t.xp6(3),t.Q6J("ngClass",t.VKq(43,I,0===s.task.priority)),t.xp6(4),t.Q6J("svgIcon","heroicons_mini:arrow-long-down"),t.xp6(1),t.Q6J("ngClass",t.VKq(45,I,1===s.task.priority)),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:minus"),t.xp6(1),t.Q6J("ngClass",t.VKq(47,I,2===s.task.priority)),t.xp6(4),t.Q6J("svgIcon","heroicons_mini:arrow-long-up"),t.xp6(4),t.Q6J("ngClass",t.kEZ(49,Et,!s.task.dueDate,s.task.dueDate&&!s.isOverdue(),s.task.dueDate&&s.isOverdue())),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:calendar"),t.xp6(2),t.Q6J("ngIf",s.task.dueDate),t.xp6(1),t.Q6J("ngIf",!s.task.dueDate),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("formControlName","dueDate")("matDatepicker",l),t.xp6(6),t.Q6J("color","primary"),t.xp6(3),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("formControlName","notes")("spellcheck",!1)}},dependencies:[m.u5,m._Y,m.Fj,m.JJ,m.JL,m.UX,m.sg,m.u,_.ot,_.lW,_.o6,_.RK,u.O5,b.Ps,b.Hw,y.Tx,y.VK,y.OP,y.p6,p.rH,U.t,U.d,v.lN,v.KE,v.hX,v.R9,R.c,R.Nt,J.IC,J.Ky,u.ax,F.si,F.wG,w.p9,w.oG,u.mk,f.FA,f.Mq,f.hl,f.M5,f.dp,f.DK,P.K,u.uU],styles:["\n    .mat-datepicker-popup {\n        scale:0.7;\n        translate: 0px 70px !important;\n    }\n"],encapsulation:2,changeDetection:0})}return n})(),Pt=(()=>{class n{constructor(){}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["tasks"]],standalone:!0,features:[t.jDz],decls:1,vars:0,template:function(i,s){1&i&&t._UZ(0,"router-outlet")},dependencies:[p.lC],encapsulation:2,changeDetection:0})}return n})();var qt=r(6306),zt=r(8504);const Kt=[{path:"",component:Pt,resolve:{tags:()=>(0,t.f3M)(T).getTags()},children:[{path:"",component:E,resolve:{tasks:()=>(0,t.f3M)(T).getTasks()},children:[{path:":id",component:Yt,resolve:{task:(n,o)=>{const e=(0,t.f3M)(T),i=(0,t.f3M)(p.F0);return e.getTaskById(n.paramMap.get("id")).pipe((0,qt.K)(s=>{console.error(s);const a=o.url.split("/").slice(0,-1).join("/");return i.navigateByUrl(a),(0,zt._)(s)}))}},canDeactivate:[(n,o,e,i)=>{let s=i.root;for(;s.firstChild;)s=s.firstChild;return!(i.url.includes("/tasks")&&!s.paramMap.get("id"))||n.closeDrawer().then(()=>!0)}]}]}]}]}}]);