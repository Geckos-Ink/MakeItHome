"use strict";(self.webpackChunkfuse=self.webpackChunkfuse||[]).push([[617],{5617:(Zt,Q,c)=>{c.r(Q),c.d(Q,{default:()=>wt});var t=c(9212),g=c(1331),_=c(6236),L=c(6672),m=c(6814),b=c(2296),f=c(617),T=c(7988);class q{constructor(a){this.id=a.id||null,this.title=a.title,this.description=a.description||null,this.icon=a.icon||null,this.lastActivity=a.lastActivity||null,this.lists=[],this.labels=[],this.members=[],a.lists&&(this.lists=a.lists.map(e=>e instanceof B?e:new B(e))),a.labels&&(this.labels=a.labels.map(e=>e instanceof w?e:new w(e))),a.members&&(this.members=a.members.map(e=>e instanceof F?e:new F(e)))}}class B{constructor(a){this.id=a.id||null,this.boardId=a.boardId,this.position=a.position,this.title=a.title,this.cards=[],a.cards&&(this.cards=a.cards.map(e=>e instanceof A?e:new A(e)))}}class A{constructor(a){this.id=a.id||null,this.boardId=a.boardId,this.listId=a.listId,this.position=a.position,this.title=a.title,this.description=a.description||null,this.labels=[],this.dueDate=a.dueDate||null,a.labels&&(this.labels=a.labels.map(e=>e instanceof w?e:new w(e)))}}class F{constructor(a){this.id=a.id||null,this.name=a.name,this.avatar=a.avatar||null}}class w{constructor(a){this.id=a.id||null,this.boardId=a.boardId,this.title=a.title}}var k=c(5037),D=c(8645),y=c(9773),Z=c(6263),l=c(6223);const M=["titleInput"],j=["titleAutosize"],z=o=>({"opacity-0 pointer-events-none":o}),Y=o=>({"opacity-0":o});let X=(()=>{class o{constructor(e,r){this._changeDetectorRef=e,this._formBuilder=r,this.buttonTitle="Add a card",this.saved=new t.vpe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){const e=this.form.get("title").value;!e||""===e.trim()||(this.saved.next(e.trim()),this.formVisible=!1,this.form.get("title").setValue(""),setTimeout(()=>{this.titleInput.nativeElement.value="",this.titleAutosize.reset()}),this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(t.sBO),t.Y36(l.QS))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["scrumboard-board-add-card"]],viewQuery:function(r,i){if(1&r&&(t.Gf(M,5),t.Gf(j,5)),2&r){let n;t.iGM(n=t.CRH())&&(i.titleInput=n.first),t.iGM(n=t.CRH())&&(i.titleAutosize=n.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},standalone:!0,features:[t.jDz],decls:17,vars:18,consts:[[1,"p-3","pt-0"],[1,"relative","flex","w-full","h-full","rounded-lg"],["mat-button","","disableRipple","",1,"absolute","inset-0","justify-start","w-full","rounded-lg",3,"ngClass","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","text-secondary"],[1,"flex","flex-col","items-start","w-full",3,"ngClass","formGroup"],[1,"flex","w-full","p-5","rounded-lg","shadow","bg-card"],["cdkTextareaAutosize","",1,"w-full","text-lg","font-medium","leading-5",3,"spellcheck","formControlName","placeholder","keydown.enter"],["titleInput","","titleAutosize","cdkTextareaAutosize"],[1,"flex","items-center","mt-2"],["mat-flat-button","",1,"h-8","min-h-8",3,"color","type","click"],["mat-icon-button","",1,"ml-1","w-8","h-8","min-h-8",3,"type","click"],[1,"icon-size-4",3,"svgIcon"]],template:function(r,i){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return i.toggleFormVisibility()}),t._UZ(3,"mat-icon",3),t.TgZ(4,"span",4),t._uU(5),t.qZA()(),t.TgZ(6,"form",5)(7,"div",6)(8,"textarea",7,8),t.NdJ("keydown.enter",function(){return i.save()}),t._uU(11,"                "),t.qZA()(),t.TgZ(12,"div",9)(13,"button",10),t.NdJ("click",function(){return i.save()}),t._uU(14," Add card "),t.qZA(),t.TgZ(15,"button",11),t.NdJ("click",function(){return i.toggleFormVisibility()}),t._UZ(16,"mat-icon",12),t.qZA()()()()()),2&r&&(t.ekj("h-13",!i.formVisible),t.xp6(2),t.Q6J("ngClass",t.VKq(14,z,i.formVisible)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus-circle"),t.xp6(2),t.Oqu(i.buttonTitle),t.xp6(1),t.Q6J("ngClass",t.VKq(16,Y,!i.formVisible))("formGroup",i.form),t.xp6(2),t.Q6J("spellcheck","off")("formControlName","title")("placeholder","Enter card title..."),t.xp6(5),t.Q6J("color","primary")("type","button"),t.xp6(2),t.Q6J("type","button"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:x-mark"))},dependencies:[b.ot,b.lW,b.RK,m.mk,f.Ps,f.Hw,l.u5,l._Y,l.Fj,l.JJ,l.JL,l.UX,l.sg,l.u,Z.Ky,Z.IC],encapsulation:2,changeDetection:0})}return o})();const E=["titleInput"],K=o=>({"opacity-0 pointer-events-none":o}),G=o=>({"opacity-0":o});let H=(()=>{class o{constructor(e,r){this._changeDetectorRef=e,this._formBuilder=r,this.buttonTitle="Add a list",this.saved=new t.vpe,this.formVisible=!1}ngOnInit(){this.form=this._formBuilder.group({title:[""]})}save(){const e=this.form.get("title").value;!e||""===e.trim()||(this.saved.next(e.trim()),this.form.get("title").setValue(""),this.formVisible=!1,this._changeDetectorRef.markForCheck())}toggleFormVisibility(){this.formVisible=!this.formVisible,this.formVisible&&this.titleInput.nativeElement.focus()}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(t.sBO),t.Y36(l.QS))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["scrumboard-board-add-list"]],viewQuery:function(r,i){if(1&r&&t.Gf(E,5),2&r){let n;t.iGM(n=t.CRH())&&(i.titleInput=n.first)}},inputs:{buttonTitle:"buttonTitle"},outputs:{saved:"saved"},standalone:!0,features:[t.jDz],decls:14,vars:18,consts:[[1,"mt-11","w-64","py-2.5","px-2"],[1,"relative","flex","w-full","h-full","overflow-hidden","rounded-xl","bg-gray-200","dark:bg-gray-700"],["mat-button","","disableRipple","",1,"absolute","inset-0","justify-start","w-full","px-3","rounded-xl","bg-transparent",3,"ngClass","click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","text-secondary"],[1,"flex","flex-col","items-start","w-full","p-3",3,"ngClass","formGroup"],[1,"w-full","py-2","px-3","leading-5","rounded-md","shadow-sm","border","border-gray-300","bg-white","focus:border-primary","dark:border-gray-500","dark:focus:border-primary","dark:bg-black","dark:bg-opacity-5",3,"autocomplete","formControlName","placeholder","keydown.enter"],["titleInput",""],[1,"flex","items-center","mt-2"],["mat-flat-button","",1,"h-8","min-h-8",3,"color","type","click"],["mat-icon-button","",1,"ml-1","w-8","h-8","min-h-8",3,"type","click"],[1,"icon-size-4",3,"svgIcon"]],template:function(r,i){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"button",2),t.NdJ("click",function(){return i.toggleFormVisibility()}),t._UZ(3,"mat-icon",3),t.TgZ(4,"span",4),t._uU(5),t.qZA()(),t.TgZ(6,"form",5)(7,"input",6,7),t.NdJ("keydown.enter",function(){return i.save()}),t.qZA(),t.TgZ(9,"div",8)(10,"button",9),t.NdJ("click",function(){return i.save()}),t._uU(11," Add list "),t.qZA(),t.TgZ(12,"button",10),t.NdJ("click",function(){return i.toggleFormVisibility()}),t._UZ(13,"mat-icon",11),t.qZA()()()()()),2&r&&(t.ekj("h-15",!i.formVisible),t.xp6(2),t.Q6J("ngClass",t.VKq(14,K,i.formVisible)),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:plus-circle"),t.xp6(2),t.Oqu(i.buttonTitle),t.xp6(1),t.Q6J("ngClass",t.VKq(16,G,!i.formVisible))("formGroup",i.form),t.xp6(1),t.Q6J("autocomplete","off")("formControlName","title")("placeholder","Enter list title..."),t.xp6(3),t.Q6J("color","primary")("type","button"),t.xp6(2),t.Q6J("type","button"),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:x-mark"))},dependencies:[b.ot,b.lW,b.RK,m.mk,f.Ps,f.Hw,l.u5,l._Y,l.Fj,l.JJ,l.JL,l.UX,l.sg,l.u],encapsulation:2,changeDetection:0})}return o})();var I=c(8203),h=c(2276),$=c(6278),u=c(5619),P=c(7398),S=c(9397),W=c(9862);let x=(()=>{class o{constructor(e){this._httpClient=e,this._board=new u.X(null),this._boards=new u.X(null),this._card=new u.X(null)}get board$(){return this._board.asObservable()}get boards$(){return this._boards.asObservable()}get card$(){return this._card.asObservable()}getBoards(){return this._httpClient.get("api/apps/scrumboard/boards").pipe((0,P.U)(e=>e?e.map(r=>new q(r)):[]),(0,S.b)(e=>this._boards.next(e)))}updateBoards(){return this._httpClient.patch("api/apps/scrumboard/boards",this._boards.getValue()).pipe((0,S.b)(e=>{this._boards.next(e)}))}getBoard(e){let r=this._boards.getValue(),i=null;for(let s of r)if(s.id==e){i=s;break}return this._board.next(i),new u.X(i).asObservable()}createBoard(e){let r=this._boards.getValue()||[];return r.push(e),this._boards.next(r),this.updateBoards().subscribe(),new u.X(e).asObservable()}updateBoard(e,r){let i=this._boards.getValue();const n=i.findIndex(d=>d.id===e);return i[n]=r,this._boards.next(i),this.updateBoards().subscribe(),new u.X(r).asObservable()}deleteBoard(e){let r=this._boards.getValue();const i=r.findIndex(s=>s.id===e);return r.splice(i,1),this._boards.next(r),this.updateBoards().subscribe(),new u.X(!0).asObservable()}createList(e){const r=this._board.value;return r.lists=[...r.lists,e],r.lists.sort((n,s)=>n.position-s.position),this._board.next(r),this.updateBoards().subscribe(),new u.X(e).asObservable()}updateList(e){const r=this._board.value,i=r.lists.findIndex(s=>s.id===e.id);return r.lists[i]=e,r.lists.sort((s,d)=>s.position-d.position),this._board.next(r),this.updateBoards().subscribe(),new u.X(e).asObservable()}updateLists(e){const r=this._board.value;return e.forEach(n=>{const s=r.lists.findIndex(d=>d.id===n.id);r.lists[s]=n}),r.lists.sort((n,s)=>n.position-s.position),this._board.next(r),this.updateBoard(r.id,r).subscribe(),new u.X(e).asObservable()}deleteList(e){const r=this._board.value,i=r.lists.findIndex(s=>s.id===e);return r.lists.splice(i,1),r.lists.sort((s,d)=>s.position-d.position),this._board.next(r),this.updateBoard(r.id,r).subscribe(),new u.X(!0).asObservable()}getCard(e){const i=this._board.getValue().lists.find(s=>s.cards.some(d=>d.id===e)).cards.find(s=>s.id===e);return this._card.next(i),new u.X(i).asObservable()}createCard(e){const r=this._board.value;return r.lists.forEach((n,s,d)=>{n.id===e.listId&&d[s].cards.push(e)}),this._board.next(r),this.updateBoard(r.id,r).subscribe(),new u.X(e).asObservable()}updateCard(e,r){const i=this._board.value;return i.lists.forEach(s=>{s.cards.forEach((d,p,C)=>{d.id===e&&(C[p]=r)})}),this._board.next(i),this._card.next(r),this.updateBoard(i.id,i).subscribe(),new u.X(r).asObservable()}updateCards(e){const r=this._board.value;return e.forEach(n=>{const s=r.lists.findIndex(p=>p.id===n.listId),d=r.lists[s].cards.findIndex(p=>p.id===n.id);r.lists[s].cards[d]=n,r.lists[s].cards.sort((p,C)=>p.position-C.position)}),this._board.next(r),this.updateBoard(r.id,r).subscribe(),new u.X(e).asObservable()}deleteCard(e){const r=this._board.value;return r.lists.forEach(n=>{n.cards.forEach((s,d,p)=>{s.id===e&&p.splice(d,1)})}),this._board.next(r),this._card.next(null),this.updateBoard(r.id,r).subscribe(),new u.X(!0).asObservable()}createLabel(e){const r=this._board.value;return r.labels=[...r.labels,e],this._board.next(r),this.updateBoard(r.id,r).subscribe(),new u.X(e).asObservable()}updateLabel(e,r){const i=this._board.value,n=i.labels.findIndex(d=>d.id===e);return i.labels[n]=r,this._board.next(i),this.updateBoard(i.id,i).subscribe(),new u.X(r).asObservable()}deleteLabel(e){const r=this._board.value,i=r.labels.findIndex(s=>s.id===e);return r.labels.splice(i,1),r.lists.forEach(s=>{s.cards.forEach(d=>{const p=d.labels.findIndex(C=>C.id===e);p>-1&&d.labels.splice(p,1)})}),this._board.next(r),this.updateBoard(r.id,r).subscribe(),new u.X(!0).asObservable()}search(e){return this._httpClient.get("api/apps/scrumboard/board/search",{params:{query:e}})}static#t=this.\u0275fac=function(r){return new(r||o)(t.LFG(W.eN))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function tt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",31),t._UZ(2,"img",32),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit;t.xp6(2),t.Q6J("src",e.coverImage,t.LSH)}}function et(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",34),t._uU(2),t.qZA(),t.BQk()),2&o){const e=a.$implicit;t.xp6(2),t.hij(" ",e.title," ")}}function rt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div")(2,"div",33),t.YNc(3,et,3,1,"ng-container",13),t.qZA()(),t.BQk()),2&o){const e=t.oxw().$implicit,r=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.labels)("ngForTrackBy",r.trackByFn)}}const it=o=>({"text-red-600":o});function ot(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",35),t._UZ(2,"mat-icon",36),t.TgZ(3,"div",22),t._uU(4),t.ALo(5,"date"),t.qZA()(),t.BQk()),2&o){const e=t.oxw().$implicit,r=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.VKq(6,it,r.isOverdue(e.dueDate))),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:clock"),t.xp6(2),t.hij(" ",t.xi3(5,3,e.dueDate,"longDate")," ")}}const nt=o=>["card",o];function st(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"a",28),t.YNc(2,tt,3,1,"ng-container",29),t.TgZ(3,"div",30),t._uU(4),t.qZA(),t.YNc(5,rt,4,2,"ng-container",29)(6,ot,6,8,"ng-container",29),t.qZA(),t.BQk()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(5,nt,e.id)),t.xp6(1),t.Q6J("ngIf",e.coverImage),t.xp6(2),t.Oqu(e.title),t.xp6(1),t.Q6J("ngIf",e.labels.length),t.xp6(1),t.Q6J("ngIf",e.dueDate)}}function at(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",16)(2,"div",17)(3,"div",18)(4,"input",19,20),t.NdJ("focusout",function(i){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.updateListTitle(i,s))})("keydown.enter",function(){t.CHM(e);const i=t.MAs(5);return t.KtG(i.blur())}),t.qZA()(),t.TgZ(6,"div",21),t._uU(7),t.qZA(),t.TgZ(8,"div",22)(9,"button",23),t._UZ(10,"mat-icon",7),t.qZA(),t.TgZ(11,"mat-menu",null,24)(13,"button",25),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(5),n=t.oxw();return t.KtG(n.renameList(i))}),t._UZ(14,"mat-icon",7),t._uU(15," Rename list "),t.qZA(),t.TgZ(16,"button",25),t.NdJ("click",function(){const n=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.deleteList(n.id))}),t._UZ(17,"mat-icon",7),t._uU(18," Delete list "),t.qZA()()()(),t.TgZ(19,"div",26)(20,"div",27),t.NdJ("cdkDropListDropped",function(i){t.CHM(e);const n=t.oxw();return t.KtG(n.cardDropped(i))}),t.YNc(21,st,7,7,"ng-container",13),t.qZA(),t.TgZ(22,"scrumboard-board-add-card",14),t.NdJ("saved",function(i){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.addCard(s,i))}),t.qZA()()(),t.BQk()}if(2&o){const e=a.$implicit,r=t.MAs(12),i=t.oxw();t.xp6(1),t.Q6J("cdkDragLockAxis","x"),t.xp6(3),t.Q6J("spellcheck","false")("value",e.title),t.xp6(3),t.hij(" ",e.cards.length," "),t.xp6(2),t.Q6J("matMenuTriggerFor",r),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:ellipsis-vertical"),t.xp6(4),t.Q6J("svgIcon","heroicons_solid:pencil-square"),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:trash"),t.xp6(3),t.Q6J("id",e.id)("cdkDropListData",e.cards),t.xp6(1),t.Q6J("ngForOf",e.cards)("ngForTrackBy",i.trackByFn),t.xp6(1),t.Q6J("buttonTitle",e.cards.length?"Add another card":"Add a card")}}const dt=()=>[".."];let ct=(()=>{class o{constructor(e,r,i,n,s){this._changeDetectorRef=e,this._formBuilder=r,this._fuseConfirmationService=i,this._scrumboardService=n,this.router=s,this._positionStep=65536,this._maxListCount=200,this._maxPosition=500*this._positionStep,this._unsubscribeAll=new D.x}ngOnInit(){this.listTitleForm=this._formBuilder.group({title:[""]}),this._scrumboardService.board$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(n=>{this.board={...n},this._changeDetectorRef.markForCheck()});let e=null;h("#scrumboard-board-name").on("keypress",()=>{clearTimeout(e),e=setTimeout(()=>{this.board.title=h("#scrumboard-board-name").html(),this._scrumboardService.updateBoard(this.board.id,this.board)},100)});let r=null;h("#scrumboard-board-description").on("keypress",()=>{clearTimeout(r),r=setTimeout(()=>{this.board.description=h("#scrumboard-board-description").html(),this._scrumboardService.updateBoard(this.board.id,this.board)},100)});let i=0;h("#scrumboard-deleteBoard").on("click",()=>{0==i?(h("#scrumboard-deleteBoard").css("background-color","rgba(255,0,0,1)"),setTimeout(()=>{h("#scrumboard-deleteBoard").css("background-color","rgba(255,100,100,0.75)"),i=0},5e3)):(this._scrumboardService.deleteBoard(this.board.id),this.router.navigate(["/apps/scrumboard/"])),i++})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete(),h("#scrumboard-board-name").off("keypress"),h("#scrumboard-board-description").off("keypress"),h("#scrumboard-deleteBoard").off("click")}renameList(e){setTimeout(()=>{e.focus()})}addList(e){if(this.board.lists.length>=this._maxListCount)return;const r=new B({id:I.Eq.guid(),boardId:this.board.id,position:this.board.lists.length?this.board.lists[this.board.lists.length-1].position+this._positionStep:this._positionStep,title:e});this._scrumboardService.createList(r).subscribe()}updateListTitle(e,r){const i=e.target,n=i.value;n&&""!==n.trim()?(r.title=i.value=n.trim(),this._scrumboardService.updateList(r).subscribe()):i.value=r.title}deleteList(e){this._fuseConfirmationService.open({title:"Delete list",message:"Are you sure you want to delete this list and its cards? This action cannot be undone!",actions:{confirm:{label:"Delete"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._scrumboardService.deleteList(e).subscribe()})}addCard(e,r){const i=new A({id:I.Eq.guid(),boardId:this.board.id,listId:e.id,position:e.cards.length?e.cards[e.cards.length-1].position+this._positionStep:this._positionStep,title:r});this._scrumboardService.createCard(i).subscribe()}listDropped(e){(0,_.bA)(e.container.data,e.previousIndex,e.currentIndex);const r=this._calculatePositions(e);this._scrumboardService.updateLists(r).subscribe()}cardDropped(e){e.previousContainer===e.container?(0,_.bA)(e.container.data,e.previousIndex,e.currentIndex):((0,_.EA)(e.previousContainer.data,e.container.data,e.previousIndex,e.currentIndex),e.container.data[e.currentIndex].listId=e.container.id);const r=this._calculatePositions(e);this._scrumboardService.updateCards(r).subscribe()}isOverdue(e){return k.ou.fromISO(e).startOf("day")<k.ou.now().startOf("day")}trackByFn(e,r){return r.id||e}_calculatePositions(e){let r=e.container.data;const i=r[e.currentIndex],n=r[e.currentIndex-1]||null,s=r[e.currentIndex+1]||null;return i.position=n?s?(n.position+s.position)/2:n.position+this._positionStep:s?s.position/2:this._positionStep,!Number.isInteger(i.position)||i.position>=this._maxPosition?(r=r.map((d,p)=>(d.position=(p+1)*this._positionStep,d)),r):[i]}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(t.sBO),t.Y36(l.QS),t.Y36($.R),t.Y36(x),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["scrumboard-board"]],standalone:!0,features:[t.jDz],decls:23,vars:11,consts:[[1,"absolute","inset-0","flex","flex-col","min-w-0"],[1,"flex","flex-col","sm:flex-row","flex-0","sm:items-center","sm:justify-between","p-6","sm:py-8","sm:px-10","border-b","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],["id","scrumboard-board-name","contenteditable","true",1,"text-2xl","md:text-3xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],["id","scrumboard-board-description","contenteditable","true",1,"text-1xl","md:text-2xl","font-extrabold","tracking-tight","leading-7","sm:leading-10","truncate"],[1,"flex","shrink-0","items-center","mt-6","sm:mt-0","sm:ml-4"],["mat-stroked-button","","id","scrumboard-deleteBoard",2,"margin-right","30px","background-color","rgba(255,100,100,0.75)"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2"],["mat-stroked-button","",3,"routerLink"],["cdkScrollable","",1,"flex-auto","p-6","sm:p-8","sm:pt-4"],["cdkDropList","",1,"flex",3,"cdkDropListData","cdkDropListOrientation","cdkDropListDropped"],["cdkDropListGroup","",1,"flex","items-start"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"buttonTitle","saved"],[1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none"],["cdkDrag","",1,"flex-0","w-72","p-2","rounded-2xl","bg-default",3,"cdkDragLockAxis"],["cdkDragHandle","",1,"flex","items-center","justify-between"],[1,"flex","items-center","w-full","py-2","px-3","rounded-md","cursor-text","border","border-transparent","focus-within:bg-white","focus-within:shadow-sm","focus-within:border-primary","dark:focus-within:bg-gray-900"],[1,"w-full","font-medium","leading-5","bg-transparent",3,"spellcheck","value","focusout","keydown.enter"],["listTitleInput",""],[1,"flex","items-center","justify-center","min-w-6","ml-4","text-sm","font-semibold","leading-6","rounded-full","bg-gray-300","text-secondary","dark:bg-gray-700"],[1,"ml-1"],["mat-icon-button","",1,"w-8","h-8","min-h-8",3,"matMenuTriggerFor"],["listMenu","matMenu"],["mat-menu-item","",3,"click"],[1,"mt-2","rounded-xl","bg-gray-400","bg-opacity-12","dark:bg-transparent","dark:border"],["cdkDropList","",1,"p-3","pb-0",3,"id","cdkDropListData","cdkDropListDropped"],["cdkDrag","",1,"flex","flex-col","items-start","mb-3","p-5","space-y-3","shadow","rounded-lg","overflow-hidden","bg-card",3,"routerLink"],[4,"ngIf"],[1,"text-lg","font-medium","leading-5"],[1,"-mx-5","-mt-5","mb-2"],[1,"w-full","object-cover",3,"src"],[1,"flex","flex-wrap","-mx-1","-mb-2"],[1,"mx-1","mb-2","py-0.5","px-3","rounded-full","text-sm","font-medium","text-gray-500","bg-gray-100","dark:text-gray-300","dark:bg-gray-700"],[1,"flex","items-center","rounded","text-sm","font-medium","leading-5","text-secondary",3,"ngClass"],[1,"icon-size-4","text-current",3,"svgIcon"]],template:function(r,i){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4),t.qZA(),t.TgZ(5,"h4",4),t._uU(6),t.qZA()(),t.TgZ(7,"div",5)(8,"a",6),t._UZ(9,"mat-icon",7),t.TgZ(10,"span",8),t._uU(11,"Delete"),t.qZA()(),t.TgZ(12,"a",9),t._UZ(13,"mat-icon",7),t.TgZ(14,"span",8),t._uU(15,"Boards"),t.qZA()()()(),t.TgZ(16,"div",10)(17,"div",11),t.NdJ("cdkDropListDropped",function(s){return i.listDropped(s)}),t.TgZ(18,"div",12),t.YNc(19,at,23,13,"ng-container",13),t.TgZ(20,"scrumboard-board-add-list",14),t.NdJ("saved",function(s){return i.addList(s)}),t.qZA()()()()(),t.TgZ(21,"div",15),t._UZ(22,"router-outlet"),t.qZA()),2&r&&(t.xp6(4),t.hij(" ",i.board.title," "),t.xp6(2),t.hij(" ",i.board.description," "),t.xp6(3),t.Q6J("svgIcon","heroicons_solid:trash"),t.xp6(3),t.Q6J("routerLink",t.DdM(10,dt)),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:view-columns"),t.xp6(4),t.Q6J("cdkDropListData",i.board.lists)("cdkDropListOrientation","horizontal"),t.xp6(2),t.Q6J("ngForOf",i.board.lists)("ngForTrackBy",i.trackByFn),t.xp6(1),t.Q6J("buttonTitle",i.board.lists.length?"Add another list":"Add a list"))},dependencies:[b.ot,b.zs,b.RK,g.rH,f.Ps,f.Hw,L.PQ,_.Wj,_.Fd,m.ax,_.Zt,_.Bh,T.Tx,T.VK,T.OP,T.p6,m.O5,m.mk,X,H,g.lC,m.uU],styles:[".cdk-drag-preview{--tw-shadow: 0 25px 50px -12px rgb(0 0 0 / .25);--tw-shadow-colored: 0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000),var(--tw-ring-shadow, 0 0 #0000),var(--tw-shadow)}.cdk-drag-placeholder{opacity:0}.cdk-drag-animating{transition:transform .25s cubic-bezier(0,0,.2,1)}.cdk-drop-list-dragging div:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}\n"],encapsulation:2,changeDetection:0})}return o})();function lt(o,a){if(1&o&&(t.ynx(0),t._UZ(1,"img",17),t.BQk()),2&o){const e=a.$implicit;t.xp6(1),t.Q6J("src",e.avatar,t.LSH)}}function ut(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"div",18)(2,"div",19),t._uU(3),t.qZA()(),t.BQk()),2&o){const e=t.oxw(2).$implicit;t.xp6(3),t.hij(" +",e.members.slice(5).length," ")}}function pt(o,a){if(1&o&&(t.ynx(0),t._UZ(1,"div",15),t.TgZ(2,"div",16),t.YNc(3,lt,2,1,"ng-container",3)(4,ut,4,1,"ng-container",11),t.qZA(),t.BQk()),2&o){const e=t.oxw().$implicit,r=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.members.slice(0,5))("ngForTrackBy",r.trackByFn),t.xp6(1),t.Q6J("ngIf",e.members.length>5)}}const mt=o=>[o];function bt(o,a){if(1&o&&(t.ynx(0),t.TgZ(1,"a",6)(2,"div",7),t._UZ(3,"mat-icon",8),t.qZA(),t.TgZ(4,"div",9),t._uU(5),t.qZA(),t.TgZ(6,"div",10),t._uU(7),t.qZA(),t.YNc(8,pt,5,3,"ng-container",11),t.TgZ(9,"div",12)(10,"div",13),t._uU(11,"Edited:"),t.qZA(),t.TgZ(12,"div",14),t._uU(13),t.qZA()()(),t.BQk()),2&o){const e=a.$implicit,r=t.oxw();t.xp6(1),t.Q6J("routerLink",t.VKq(6,mt,e.id)),t.xp6(2),t.Q6J("svgIcon",e.icon),t.xp6(2),t.Oqu(e.title),t.xp6(2),t.Oqu(e.description),t.xp6(1),t.Q6J("ngIf",null==e.members?null:e.members.length),t.xp6(5),t.Oqu(r.formatDateAsRelative(e.lastActivity))}}let ft=(()=>{class o{constructor(e,r){this._changeDetectorRef=e,this._scrumboardService=r,this._unsubscribeAll=new D.x}ngOnInit(){this._scrumboardService.boards$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(e=>{this.boards=e,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}formatDateAsRelative(e){return k.ou.fromISO(e).toRelative()}trackByFn(e,r){return r.id||e}newBoard(){let e={id:I.Eq.guid(),title:"New Dashboard",description:"Roadmap for the new project",icon:"heroicons_outline:rectangle-group",lastActivity:(new Date).toISOString(),lists:[],labels:[],members:[]};this._scrumboardService.createBoard(e)}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(t.sBO),t.Y36(x))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["scrumboard-boards"]],standalone:!0,features:[t.jDz],decls:6,vars:3,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-auto","items-center","p-6","sm:p-10"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-4","gap-4","mt-8","md:mt-16"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","flex-col","items-center","justify-center","w-56","rounded-lg","cursor-pointer","border-2","border-gray-300","border-dashed","hover:bg-hover","transition-colors","duration-150","ease-in-out",3,"click"],[1,"icon-size-12","text-hint",3,"svgIcon"],[1,"flex","flex-col","items-start","w-56","p-6","rounded-lg","shadow","bg-card","rounded-lg","hover:shadow-xl","transition-shadow","duration-150","ease-in-out",3,"routerLink"],[1,"flex","items-center","justify-center","p-4","rounded-full","bg-primary-50","text-primary-700","dark:bg-primary","dark:text-on-primary"],[1,"text-current",3,"svgIcon"],[1,"mt-5","text-lg","font-medium","leading-5"],[1,"mt-0.5","line-clamp-2","text-secondary"],[4,"ngIf"],[1,"flex","items-center","mt-4","text-md","font-md"],[1,"text-secondary"],[1,"ml-1"],[1,"w-12","h-1","mt-6","border-t-2"],[1,"flex","items-center","mt-6","-space-x-1.5"],["alt","Member avatar",1,"flex-0","w-8","h-8","rounded-full","ring","ring-offset-1","ring-bg-card","ring-offset-transparent","object-cover",3,"src"],[1,"flex","flex-0","items-center","justify-center","w-8","h-8","rounded-full","ring","ring-offset-1","ring-bg-card","ring-offset-transparent","bg-gray-200","text-gray-500"],[1,"text-md","font-semibold"]],template:function(r,i){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,bt,14,8,"ng-container",3),t.TgZ(4,"div",4),t.NdJ("click",function(){return i.newBoard()}),t._UZ(5,"mat-icon",5),t.qZA()()()()),2&r&&(t.xp6(3),t.Q6J("ngForOf",i.boards)("ngForTrackBy",i.trackByFn),t.xp6(2),t.Q6J("svgIcon","heroicons_outline:plus"))},dependencies:[L.PQ,m.ax,g.rH,f.Ps,f.Hw,m.O5],encapsulation:2,changeDetection:0})}return o})();var O=c(5986),v=c(8034),J=c(4170),U=c(4516),ht=c(759),gt=c(3620),R=c(7700);const _t=["labelInput"];function xt(o,a){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"date"),t.BQk()),2&o){const e=t.oxw();t.xp6(1),t.Oqu(t.xi3(2,1,e.card.dueDate,"longDate"))}}function vt(o,a){1&o&&(t.ynx(0),t._uU(1,"Not set"),t.BQk())}function kt(o,a){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"mat-checkbox",26),t.NdJ("change",function(i){const s=t.CHM(e).$implicit,d=t.oxw();return t.KtG(d.toggleProductTag(s,i))}),t._uU(2),t.qZA(),t.BQk()}if(2&o){const e=a.$implicit,r=t.oxw();t.xp6(1),t.Q6J("color","primary")("checked",r.hasLabel(e)),t.xp6(1),t.hij(" ",e.title," ")}}const yt=(o,a,e)=>({"text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700":o,"text-green-800 bg-green-200 dark:text-green-100 dark:bg-green-500":a,"text-red-800 bg-red-200 dark:text-red-100 dark:bg-red-500":e});let Ct=(()=>{class o{constructor(e,r,i,n){this.matDialogRef=e,this._changeDetectorRef=r,this._formBuilder=i,this._scrumboardService=n,this._unsubscribeAll=new D.x}ngOnInit(){this._scrumboardService.board$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(e=>{this.board=e,this.labels=this.filteredLabels=e.labels}),this._scrumboardService.card$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(e=>{this.card=e}),this.cardForm=this._formBuilder.group({id:[""],title:["",l.kI.required],description:[""],labels:[[]],dueDate:[null]}),this.cardForm.setValue({id:this.card.id,title:this.card.title,description:this.card.description,labels:this.card.labels,dueDate:this.card.dueDate}),this.cardForm.valueChanges.pipe((0,S.b)(e=>{this.card=(0,ht.Z)(this.card,e)}),(0,gt.b)(300),(0,y.R)(this._unsubscribeAll)).subscribe(e=>{this._scrumboardService.updateCard(e.id,e).subscribe(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}hasLabel(e){return!!this.card.labels.find(r=>r.id===e.id)}filterLabels(e){const r=e.target.value.toLowerCase();this.filteredLabels=this.labels.filter(i=>i.title.toLowerCase().includes(r))}filterLabelsInputKeyDown(e){if("Enter"!==e.key||0===this.filteredLabels.length)return;const r=this.filteredLabels[0];this.card.labels.find(n=>n.id===r.id)?this.removeLabelFromCard(r):this.addLabelToCard(r)}toggleProductTag(e,r){r.checked?this.addLabelToCard(e):this.removeLabelFromCard(e)}addLabelToCard(e){this.card.labels.unshift(e),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}removeLabelFromCard(e){this.card.labels.splice(this.card.labels.findIndex(r=>r.id===e.id),1),this.cardForm.get("labels").patchValue(this.card.labels),this._changeDetectorRef.markForCheck()}isOverdue(e){return k.ou.fromISO(e).startOf("day")<k.ou.now().startOf("day")}trackByFn(e,r){return r.id||e}_readAsDataURL(e){return new Promise((r,i)=>{const n=new FileReader;n.onload=()=>{r(n.result)},n.onerror=s=>{i(s)},n.readAsDataURL(e)})}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(R.so),t.Y36(t.sBO),t.Y36(l.QS),t.Y36(x))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["scrumboard-card-details"]],viewQuery:function(r,i){if(1&r&&t.Gf(_t,5),2&r){let n;t.iGM(n=t.CRH())&&(i.labelInput=n.first)}},standalone:!0,features:[t.jDz],decls:44,vars:27,consts:[[1,"flex","flex-col","flex-auto"],[1,"flex","flex-0","items-center","justify-between","h-16","pr-3","sm:pr-5","pl-6","sm:pl-8","bg-primary","text-on-primary"],[1,"text-lg","font-medium"],["mat-icon-button","",3,"tabIndex","click"],[1,"text-current",3,"svgIcon"],[1,"flex","flex-col","flex-0","items-start","w-full","p-6","sm:p-8","space-y-6",3,"formGroup"],[1,"w-full",3,"subscriptSizing"],["matInput","","cdkTextareaAutosize","",3,"formControlName","rows","cdkAutosizeMinRows"],[1,"font-medium"],[1,"relative","flex","items-center","mt-1.5","px-4","leading-9","rounded-full","cursor-pointer",3,"ngClass","click"],[1,"icon-size-5","text-current",3,"svgIcon"],[1,"ml-2","text-md","font-medium"],[4,"ngIf"],[1,"fuse-mat-dense","invisible","absolute","inset-0","-mt-2.5","opacity-0","pointer-events-none",3,"subscriptSizing"],["matInput","",3,"formControlName","matDatepicker"],["dueDatePicker",""],["mat-button","","matDatepickerCancel","",3,"click"],["mat-flat-button","","matDatepickerApply","",3,"color"],[1,"w-full"],[1,"mt-1","rounded-md","border","border-gray-300","shadow-sm","overflow-hidden"],[1,"flex","items-center","my-2","mx-3"],[1,"flex","items-center","flex-auto","min-w-0"],[1,"icon-size-5",3,"svgIcon"],["type","text","placeholder","Enter label name",1,"min-w-0","ml-2","py-1","border-0",3,"maxLength","input","keydown"],[1,"max-h-40","leading-none","overflow-y-auto","border-t"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"flex","items-center","h-10","min-h-10","pl-1","pr-4",3,"color","checked","change"]],template:function(r,i){if(1&r){const n=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Card"),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return i.matDialogRef.close()}),t._UZ(5,"mat-icon",4),t.qZA()(),t.TgZ(6,"form",5)(7,"mat-form-field",6)(8,"mat-label"),t._uU(9,"Title"),t.qZA(),t.TgZ(10,"textarea",7),t._uU(11,"            "),t.qZA()(),t.TgZ(12,"mat-form-field",6)(13,"mat-label"),t._uU(14,"Description"),t.qZA(),t.TgZ(15,"textarea",7),t._uU(16,"            "),t.qZA()(),t.TgZ(17,"div")(18,"div",8),t._uU(19,"Due date"),t.qZA(),t.TgZ(20,"div",9),t.NdJ("click",function(){t.CHM(n);const d=t.MAs(28);return t.KtG(d.open())}),t._UZ(21,"mat-icon",10),t.TgZ(22,"span",11),t.YNc(23,xt,3,4,"ng-container",12)(24,vt,2,0,"ng-container",12),t.qZA(),t.TgZ(25,"mat-form-field",13),t._UZ(26,"input",14),t.TgZ(27,"mat-datepicker",null,15)(29,"mat-datepicker-actions")(30,"button",16),t.NdJ("click",function(){return i.cardForm.get("dueDate").setValue(null)}),t._uU(31," Clear "),t.qZA(),t.TgZ(32,"button",17),t._uU(33," Select "),t.qZA()()()()()(),t.TgZ(34,"div",18)(35,"div",8),t._uU(36,"Labels"),t.qZA(),t.TgZ(37,"div",19)(38,"div",20)(39,"div",21),t._UZ(40,"mat-icon",22),t.TgZ(41,"input",23),t.NdJ("input",function(d){return i.filterLabels(d)})("keydown",function(d){return i.filterLabelsInputKeyDown(d)}),t.qZA()()(),t.TgZ(42,"div",24),t.YNc(43,kt,3,3,"ng-container",25),t.qZA()()()()()}if(2&r){const n=t.MAs(28);t.xp6(4),t.Q6J("tabIndex",-1),t.xp6(1),t.Q6J("svgIcon","heroicons_outline:x-mark"),t.xp6(1),t.Q6J("formGroup",i.cardForm),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("formControlName","title")("rows",1)("cdkAutosizeMinRows",1),t.xp6(2),t.Q6J("subscriptSizing","dynamic"),t.xp6(3),t.Q6J("formControlName","description")("rows",1)("cdkAutosizeMinRows",1),t.xp6(5),t.Q6J("ngClass",t.kEZ(23,yt,!i.card.dueDate,i.card.dueDate&&!i.isOverdue(i.card.dueDate),i.card.dueDate&&i.isOverdue(i.card.dueDate))),t.xp6(1),t.Q6J("svgIcon","heroicons_solid:calendar"),t.xp6(2),t.Q6J("ngIf",i.card.dueDate),t.xp6(1),t.Q6J("ngIf",!i.card.dueDate),t.xp6(1),t.Q6J("subscriptSizing","dynamic"),t.xp6(1),t.Q6J("formControlName","dueDate")("matDatepicker",n),t.xp6(6),t.Q6J("color","primary"),t.xp6(8),t.Q6J("svgIcon","heroicons_solid:magnifying-glass"),t.xp6(1),t.Q6J("maxLength",50),t.xp6(2),t.Q6J("ngForOf",i.filteredLabels)("ngForTrackBy",i.trackByFn)}},dependencies:[b.ot,b.lW,b.RK,f.Ps,f.Hw,l.u5,l._Y,l.Fj,l.JJ,l.JL,l.UX,l.sg,l.u,J.lN,J.KE,J.hX,U.c,U.Nt,Z.IC,Z.Ky,m.mk,m.O5,v.FA,v.Mq,v.hl,v.M5,v.dp,v.DK,m.ax,O.p9,O.oG,m.uU],styles:["\n    .mat-mdc-dialog-container{\n        scale: 0.65;translate: 0px -90px !important; min-width:800px;\n    }\n\n    .mat-datepicker-popup {\n        scale:0.7;\n        translate: 0px 70px !important;                \n    }\n"],encapsulation:2,changeDetection:0})}return o})(),Tt=(()=>{class o{constructor(e,r,i){this._activatedRoute=e,this._matDialog=r,this._router=i}ngOnInit(){this._matDialog.open(Ct,{autoFocus:!1}).afterClosed().subscribe(()=>{this._router.navigate(["./../.."],{relativeTo:this._activatedRoute})})}static#t=this.\u0275fac=function(r){return new(r||o)(t.Y36(g.gz),t.Y36(R.uw),t.Y36(g.F0))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["scrumboard-card"]],standalone:!0,features:[t.jDz],decls:1,vars:0,template:function(r,i){1&r&&t._uU(0,"SCRUMBOARD -> BOARDS -> LIST -> CARD\n")},encapsulation:2,changeDetection:0})}return o})();var N=c(6306),V=c(8504);const wt=[{path:"",component:ft,resolve:{boards:()=>(0,t.f3M)(x).getBoards()}},{path:":boardId",component:ct,resolve:{board:(o,a)=>{const e=(0,t.f3M)(x),r=(0,t.f3M)(g.F0);return e.getBoard(o.paramMap.get("boardId")).pipe((0,N.K)(i=>{console.error(i);const n=a.url.split("/").slice(0,-1).join("/");return r.navigateByUrl(n),(0,V._)(i)}))}},children:[{path:"card/:cardId",component:Tt,resolve:{card:(o,a)=>{const e=(0,t.f3M)(x),r=(0,t.f3M)(g.F0);return e.getCard(o.paramMap.get("cardId")).pipe((0,N.K)(i=>{console.error(i);const n=a.url.split("/").slice(0,-1).join("/");return r.navigateByUrl(n),(0,V._)(i)}))}}}]}]}}]);